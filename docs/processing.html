---

title: processing


keywords: fastai
sidebar: home_sidebar

summary: "Processing the different stream of data to calculate responses of retinal cells"
description: "Processing the different stream of data to calculate responses of retinal cells"
nb_path: "02_processing.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_processing.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Spatial-stimulus-(checkerboard)">Spatial stimulus (checkerboard)<a class="anchor-link" href="#Spatial-stimulus-(checkerboard)"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="eyetrack_stim_inten" class="doc_header"><code>eyetrack_stim_inten</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>eyetrack_stim_inten</code>(<strong><code>stim_inten</code></strong>, <strong><code>eye_track</code></strong>, <strong><code>upsampling</code></strong>=<em><code>2</code></em>, <strong><code>eye_calib</code></strong>=<em><code>[[94, 8], [18, 59]]</code></em>, <strong><code>box_w</code></strong>=<em><code>None</code></em>, <strong><code>box_h</code></strong>=<em><code>None</code></em>, <strong><code>stim_axis</code></strong>=<em><code>'x'</code></em>)</p>
</blockquote>
<p>From stimulus data and eye tracking, returns a corrected and upsampled stimulus data.
Calibration corresponds to the width and height of the stimulus screen, in
terms of pixels in the eye video: [[WIDTH_x, WIDTH_y], [HEIGHT_x, HEIGHT_y]]</p>
<p>params:</p>

<pre><code>- stim_inten: Stimulus intensity matrix of shape (t, y, x), or (t, x) or (t, y) depending on stim_axis
- eye_track: Eye tracking data of shape (t, x_pos, y_pos, ...)
- upsampling: Factor for the upsampling (2 will multiply by 2 number of box in width and height)
- eye_calib: Calibration matrix of shape (2,2)
- box_w: Width of a block in pixel (40px in case of a 32 box in width of a checkerboard on a 1280px width)
- box_h: Height of a block in pixel. Both box_x and box_h are calculated from a 1280x720 screen if None
- stim_axis: Specify which direction to shift in case of stim shape different than (t, y, x)

</code></pre>
<p>return:</p>

<pre><code>- Upsampled and shift corrected stimulus intensity</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="saccade_distances" class="doc_header"><code>saccade_distances</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L103" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>saccade_distances</code>(<strong><code>eye_track</code></strong>)</p>
</blockquote>
<p>Create a mask for the eye position timeserie that indicate how far was the last saccade.
The eye positions need to be smoothed with smooth_eye_position.</p>
<p>params:</p>

<pre><code>- eye_track: Eye tracking data of shape (t, x_pos, y_pos, ...)

</code></pre>
<p>return:</p>

<pre><code>- Distance to last saccade array</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="smooth_eye_position" class="doc_header"><code>smooth_eye_position</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L127" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>smooth_eye_position</code>(<strong><code>eye_track</code></strong>, <strong><code>threshold</code></strong>=<em><code>2</code></em>)</p>
</blockquote>
<p>Smooth the eye positions. Uses clustering of eye position epochs to smooth.
Clustering is made with sklearn.cluster.dbscan.</p>
<p>params:</p>

<pre><code>- eye_track: Eye tracking data of shape (t, x_pos, y_pos, ...)
- threshold: Distance threshold in the position clustering

</code></pre>
<p>return:</p>

<pre><code>- Distance to last saccade array</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="process_sta_batch" class="doc_header"><code>process_sta_batch</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L194" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>process_sta_batch</code>(<strong><code>stim_inten</code></strong>, <strong><code>spike_counts</code></strong>, <strong><code>Hw</code></strong>=<em><code>30</code></em>, <strong><code>Fw</code></strong>=<em><code>2</code></em>, <strong><code>return_pval</code></strong>=<em><code>False</code></em>, <strong><code>normalisation</code></strong>=<em><code>'abs'</code></em>)</p>
</blockquote>
<p>Computes the STA and associated pvalues in parallel for a batch of cells.</p>
<p>params:</p>

<pre><code>- stim_inten: stimulus intensity matrix of shape (t, ...)
- spike_counts: cells activity matrix of shape (t, n_cell)
- Hw: Lenght in frames of the history window, including the 0 timepoint
- Fw: Lenght in frames of the forward window
- return_pval: Flag to signal whether or not to return the pvalues
- normalisation: Normalization applied to the STA. One of ["abs", "L2", None]

</code></pre>
<p>return:</p>

<pre><code>- stas of shape (n_cell, Hw+Fw, ...)
- stas and pvalues if return_pval=True, both of shape (n_cell, Hw+Fw, ...)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="staEst_fromBins" class="doc_header"><code>staEst_fromBins</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L254" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>staEst_fromBins</code>(<strong><code>stim</code></strong>, <strong><code>spike_counts</code></strong>, <strong><code>Hw</code></strong>, <strong><code>Fw</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<p>Matrix mutliplication to compute the STA. Use the wrapper process_sta_batch to avoid bugs.</p>
<p>params:</p>

<pre><code>- stim_inten: stimulus intensity matrix of shape (flattened_frame, t)
- spike_counts: cells activity matrix of shape (t, n_cell)
- Hw: Lenght in frames of the history window, including the 0 timepoint
- Fw: Lenght in frames of the forward window

</code></pre>
<p>return:</p>

<pre><code>- STA of shape (n_cell, Hw+Fw, flattened_frame)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="process_sta_batch_large" class="doc_header"><code>process_sta_batch_large</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L284" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>process_sta_batch_large</code>(<strong><code>stim_inten</code></strong>, <strong><code>spike_counts</code></strong>, <strong><code>Hw</code></strong>=<em><code>30</code></em>, <strong><code>Fw</code></strong>=<em><code>2</code></em>, <strong><code>return_pval</code></strong>=<em><code>False</code></em>, <strong><code>normalisation</code></strong>=<em><code>'abs'</code></em>, <strong><code>bs</code></strong>=<em><code>1000</code></em>)</p>
</blockquote>
<p>Computes the STA and associated pvalues in parallel for a batch of cells, for a large stimulus.</p>
<p>params:</p>

<pre><code>- stim_inten: stimulus intensity matrix of shape (t, ...)
- spike_counts: cells activity matrix of shape (t, n_cell)
- Hw: Lenght in frames of the history window, including the 0 timepoint
- Fw: Lenght in frames of the forward window
- return_pval: Flag to signal whether or not to return the pvalues
- normalisation: Normalization applied to the STA. One of ["abs", "L2", None]
- bs: batch size to compute partial STA

</code></pre>
<p>return:</p>

<pre><code>- stas of shape (n_cell, Hw+Fw, ...)
- stas and pvalues if return_pval=True, both of shape (n_cell, Hw+Fw, ...)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cross_correlation" class="doc_header"><code>cross_correlation</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L351" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cross_correlation</code>(<strong><code>spike_counts</code></strong>, <strong><code>tail_len</code></strong>=<em><code>100</code></em>)</p>
</blockquote>
<p>From calculate the cross correlation of the cells over a time window.</p>
<p>params:</p>

<pre><code>- spike_counts of shape (t, n_cell)
- tail_len: time correlation window size

</code></pre>
<p>return:</p>

<pre><code>- cross correlation between the cells</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="corrcoef" class="doc_header"><code>corrcoef</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L378" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>corrcoef</code>(<strong><code>spike_counts</code></strong>)</p>
</blockquote>
<p>Computes correlation coefficient between the cells</p>
<p>params:</p>

<pre><code>- spike_counts: Cells activity of shape (t, n_cell)

</code></pre>
<p>return:</p>

<pre><code>- Correlation matrix</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="flatten_corrcoef" class="doc_header"><code>flatten_corrcoef</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L390" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>flatten_corrcoef</code>(<strong><code>corrcoef_matrix</code></strong>)</p>
</blockquote>
<p>Retrieves a one dimensional array of the cells correlations</p>
<p>params:</p>

<pre><code>- corrcoef_matrix: Correlation matrix from [`corrcoef`](/theonerig/processing.html#corrcoef)

</code></pre>
<p>return:</p>

<pre><code>- flattened correlation matrix</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="stimulus_ensemble" class="doc_header"><code>stimulus_ensemble</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L403" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>stimulus_ensemble</code>(<strong><code>stim_inten</code></strong>, <strong><code>Hw</code></strong>=<em><code>30</code></em>, <strong><code>x</code></strong>=<em><code>0</code></em>, <strong><code>y</code></strong>=<em><code>0</code></em>, <strong><code>w</code></strong>=<em><code>None</code></em>, <strong><code>h</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Generate the stimulus ensemble used to compute the nonlinearity</p>
<p>params:</p>

<pre><code>- stim_inten: stimulus intensity matrix of shape (t, ...)
- Hw: Lenght in frames of the history window, including the 0 timepoint
- x: Left position of the window where to get the ensemble from
- y: Up position of the window where to get the ensemble from
- w: Width of the window where to get the ensemble from. If None, is set to stim_inten.shape[2]
- h: Height of the window where to get the ensemble from. If None, is set to stim_inten.shape[1]

</code></pre>
<p>return:</p>

<pre><code>- Flatten stimulus ensemble of size (len(stim_inten)-(Hw-1), w*h*Hw). To obtain the corresponding cell activity,
slice it like so: slice(Hw-1, None)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="process_nonlinearity" class="doc_header"><code>process_nonlinearity</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L442" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>process_nonlinearity</code>(<strong><code>stim_inten</code></strong>, <strong><code>spike_counts</code></strong>, <strong><code>bins</code></strong>, <strong><code>stas</code></strong>, <strong><code>p_norm</code></strong>=<em><code>2</code></em>)</p>
</blockquote>
<p>Computes the nonlinearity of a single cell. The STA of the cell is in L2 normalization, which
should restrict the histogram values.</p>
<p>params:</p>

<pre><code>- stim_inten: stimulus intensity in shape (t, y, x)
- spike_counts: cells activity in shape (t, n_cell)
- bins: bins in which the transformed stimuli ensembles are set. (usually between -6 and 6)
- stas:  The STAs to convolve with stim_inten in shape (n_cell, Hw, ...)
- p_norm: Power for the normalization. https://en.wikipedia.org/wiki/Norm_(mathematics)#p-norm :
    1 -&gt; can compare nonlinearites of stimuli with different dimensionality
    2 -&gt; Common L2 normalization for STAs

</code></pre>
<p>return:</p>

<pre><code>- nonlinearity of the cell.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="activity_histogram" class="doc_header"><code>activity_histogram</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L515" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>activity_histogram</code>(<strong><code>spike_counts</code></strong>)</p>
</blockquote>
<p>Retrieve an histogram of the individual cells activity.</p>
<p>params:</p>

<pre><code>- spike_counts: cells activity matrix of shape (t, n_cell)

</code></pre>
<p>return:</p>

<pre><code>- Cells activity histogram</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cross_distances" class="doc_header"><code>cross_distances</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L531" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cross_distances</code>(<strong><code>masks</code></strong>)</p>
</blockquote>
<p>Computes cross distances from the center of mass of a list of mask.</p>
<p>params:</p>

<pre><code>- masks: cells mask of shape (n_mask, y, x)

</code></pre>
<p>return:</p>

<pre><code>- cross distances matrix</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cross_distances_sta" class="doc_header"><code>cross_distances_sta</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L549" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cross_distances_sta</code>(<strong><code>fits</code></strong>, <strong><code>sta_shape</code></strong>, <strong><code>f</code></strong>)</p>
</blockquote>
<p>Computes cross distances between STAs</p>
<p>params:</p>

<pre><code>- fits: fits of STA to compare
- sta_shape: shape of the STA
- f: function used to compute the stas from the fits parameters

</code></pre>
<p>return:</p>

<pre><code>- cross distances matrix</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="paired_distances" class="doc_header"><code>paired_distances</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L569" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>paired_distances</code>(<strong><code>masks_1</code></strong>, <strong><code>masks_2</code></strong>)</p>
</blockquote>
<p>Compute the distance between two masks</p>
<p>params:</p>

<pre><code>- masks_1: Mask of the first cell
- masks_2: Mask of the second cell

</code></pre>
<p>return:</p>

<pre><code>- distance between the two masks</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="paired_distances_sta" class="doc_header"><code>paired_distances_sta</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L587" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>paired_distances_sta</code>(<strong><code>sta_fits_1</code></strong>, <strong><code>sta_fits_2</code></strong>, <strong><code>sta_shape</code></strong>, <strong><code>f</code></strong>)</p>
</blockquote>
<p>Compute the distance between two STAs.</p>
<p>params:</p>

<pre><code>- sta_fits_1: fits of STA of the first cell
- sta_fits_2: fits of STA of the second cell
- sta_shape: shape of the STA
- f: function used to compute the stas from the fits parameters

</code></pre>
<p>return:</p>

<pre><code>- distance between the two STAs</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Direction-and-orientation-selectivity-with-imaginary-numbers">Direction and orientation selectivity with imaginary numbers<a class="anchor-link" href="#Direction-and-orientation-selectivity-with-imaginary-numbers"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have 8 angles</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_angle</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">n_angle</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">n_angle</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.         0.78539816 1.57079633 2.35619449 3.14159265 3.92699082
 4.71238898 5.49778714]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Exponentiating those and multiplying with 0+1i will wind up the angles around the origin in imag number space</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[ 1.00000000e+00+0.00000000e+00j  7.07106781e-01+7.07106781e-01j
  6.12323400e-17+1.00000000e+00j -7.07106781e-01+7.07106781e-01j
 -1.00000000e+00+1.22464680e-16j -7.07106781e-01-7.07106781e-01j
 -1.83697020e-16-1.00000000e+00j  7.07106781e-01-7.07106781e-01j]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And so multiplying by two before exponentiation double the angle of the arrow. It gives to originally opposite vectors the same direction -&gt; good to calculate orientation selectivity</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;axes.prop_cycle&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span>
<span class="k">for</span> <span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span> <span class="p">(</span><span class="n">vectors</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">vectors</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">.04</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;DS vectors&quot;</span><span class="p">)</span>

<span class="n">vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">vectors</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">vectors</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">colors</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;=</span><span class="mi">4</span><span class="p">:</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span><span class="o">*</span><span class="mf">0.8</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span><span class="o">*</span><span class="mf">0.8</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">.04</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;OS vectors&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;OS vectors&#39;)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="direction_selectivity" class="doc_header"><code>direction_selectivity</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L615" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>direction_selectivity</code>(<strong><code>grouped_spikes_d</code></strong>, <strong><code>n_bootstrap</code></strong>=<em><code>1000</code></em>)</p>
</blockquote>
<p>Compute the direction selectivity index of cells in the given dict containing for each condition as
the keys, an array of shape (n_angle, n_repeat, trial_len, n_cell). Such dictionnary can be obtained
by using <code>utils.group_direction_response</code>.</p>
<p>params:</p>

<pre><code>- grouped_spikes_d: Results of the group_direction_response of shape (n_angle, n_repeat, t, n_cell)
- n_bootstrap: Number of bootstrap iteration to calculate the p-value

</code></pre>
<p>return:</p>

<pre><code>- A dictionnary with a key for each condition retrieving a tuple containing list of the cells
(spike sum, direction pref, DS idx, orientation pref, OS idx, pval DS, pval OS)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="wave_direction_selectivity" class="doc_header"><code>wave_direction_selectivity</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L681" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>wave_direction_selectivity</code>(<strong><code>wave_array</code></strong>, <strong><code>spike_counts</code></strong>, <strong><code>moving_distance_th</code></strong>=<em><code>1</code></em>, <strong><code>looming_distance_th</code></strong>=<em><code>0.3</code></em>, <strong><code>n_bootstrap</code></strong>=<em><code>1000</code></em>)</p>
</blockquote>
<p>Computes the direction, orientation and looming/shrinking indexes of the cells in response to the wave stimulus (in LED dome).</p>
<p>params:</p>

<pre><code>- wave_array: The indexes of the waves from the record master.
- spike_counts: The cells response to the waves from the record master.
- moving_distance_th: Distance threshold in radians above which a stimulus can be considered for the OS and DS.
- looming_distance_th: Distance threshold in radians bellow which a stimulus can be considered for the looming/shrinking response
- n_bootstrap: Number of repetition in the bootstraping method to compute the pvalues

</code></pre>
<p>return:</p>

<pre><code>- A tuple containing lists of the cells response, in order:
    * [0] summed_responses: Summed response of a cell to each wave condition
    * [1] dir_pref_l: Direction preference vector
    * [2] dir_idx_l : Direction indexes
    * [3] dir_pval_l: Direction p_values
    * [4] ori_pref_l: Orientation preference vector
    * [5] ori_idx_l : Orientation indexes
    * [6] ori_pval_l: Orientation p_values
    * [7] loom_idx_l : Looming indexes
    * [8] loom_pval_l: Looming p_values
    * [9] stas_position_l: Position (theta, phi) of the cells receptive fields with the water stimulus
    * [10] waves_position_l: Relative positions of the waves to the cells STA.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="peri_saccadic_response" class="doc_header"><code>peri_saccadic_response</code><a href="https://github.com/Tom-TBT/theonerig/tree/master/theonerig/processing.py#L796" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>peri_saccadic_response</code>(<strong><code>spike_counts</code></strong>, <strong><code>eye_track</code></strong>, <strong><code>motion_threshold</code></strong>=<em><code>5</code></em>, <strong><code>window</code></strong>=<em><code>15</code></em>)</p>
</blockquote>
<p>Computes the cell average response around saccades.</p>
<p>params:</p>

<pre><code>- spike_counts: cells activity matrix of shape (t, n_cell)
- eye_track: Eye tracking data of shape (t, x_pos, y_pos, ...)
- motion_threshold: Amount of motion in pixel to account for a saccade
- window: Size of the window before and after the saccade on which to average the cell response

</code></pre>
<p>return:</p>

<pre><code>- peri saccadic response of cells of shape (n_cell, window*2+1)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

